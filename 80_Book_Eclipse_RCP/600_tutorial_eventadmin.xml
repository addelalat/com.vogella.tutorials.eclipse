<chapter id="tutorial_eventadmin">
== Exercise: Event notifications

=== Creating a plug-in for event constants
		
			Create a new simple plug-in called
			_com.example.e4.rcp.todo.events_
			.
		
		
			Define the following
			`MyEventConstants`
			interface in this new plug-in. This interface stores the constants
			for the event topics.
		
		
			<programlisting language="java">
				<xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
					parse="text" href="../../Eclipse4EventSystem/examples/events/MyEventConstants.java[]
----
		
		
			Export the
			`com.example.e4.rcp.todo.events`
			package in the
			_MANIFEST.MF_
			file (via the
			_Runtime_
			tab) in your new plug-in.
		
	

=== Add the new plug-in to the product via the feature
		
			Add the
			_event_
			plug-in to your feature so that it is available in your product
			configuration file.
		

	


=== Enter the plug-in dependencies
		
			Add
			_com.example.e4.rcp.todo.events_
			as a dependency
			to your
			_com.example.e4.rcp.todo_
			plug-in via its
			_MANIFEST.MF_
			file.
		
		Start your application to validate that you did everything
			correctly.
		
		WARNING:
			
				Remember to start your application via the product to update
				the
				runtime configuration. If it fails ensure that you have added
				the
				_*.todo.events_
				plug-in to the feature.
			
		
	

=== Send out notifications
		
			Ensure that the following two plug-ins are included as
			dependency into
			your
			`com.example.e4.rcp.todo`
			plug-in.
			<itemizedlist>
				*
					`org.eclipse.e4.core.services`
				
				*
					`org.eclipse.osgi.services`
				
			

		
		
			Update your
			`NewTodoHandler`
			and your
			`SaveAllHandler`
			classes to send out an event to communicate the data change. The
			following
			example code demonstrates that for the
			`NewTodoHandler`
			class.
		

		
[source,java]
----
include::res/event/NewTodoHandler.java[]
----
		

	

=== Receive updates in your parts
		
			Register for this
			event in all relevant parts of your
			application. If
			the
			event is received, update your user interface. The following code
			demonstrates that for your
			`TodoOverviewPart`
			class.
		

		
[source,java]
----
include::res/event/TodoOverviewPart.java[]
----
		
	

=== Validating

		
			Create a new
			`Todo`
			object via your wizard. The table in
			`TodoOverviewPart`
			should get updated automatically, e.g., the new entry should be
			visible in the table after you finish the wizard.
		
	

=== Review the implementation
		
			The current implementation works but is not perfect. Each
			user
			interface component, which modifies
			`Todo`
			objects,
			needs to send out events.
		
		
			It would be preferable if the
			`ITodoService`
			implementation could send out these events directly.
		
		
			In
			the
			<<contextfunctionschapter" />
			chapter we improve our current solution and move the event sending to
			the implementation class of the
			`ITodoService`
			service.
		
	

</chapter>
