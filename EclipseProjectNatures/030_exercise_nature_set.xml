= Android - Tutorial
:linkcss:
:sectnums:                                                          
:experimental:
:icons:
:imagesdir: ./img
(c) 2009, 2016 vogella GmbH
Version 0.3, 06.07.2016
:docinfodir: ../
:vgwort: 

[abstract]

== Exercise: Apply a project nature to a project
    <section>
        <title>Target
        Add a <guimenuitem>Convert to example project</guimenuitem> menu item to the
                <guimenu>Configure</guimenu> menu of a projects context menu.
    
    <section>
        <title>Define an example project nature
        Create a plugin project and add the following dependencies to it:
        
            <itemizedlist>
                <listitem>
                    org.eclipse.core.runtime
                </listitem>
                <listitem>
                    org.eclipse.core.resources
                </listitem>
                <listitem>
                    org.eclipse.ui.ide
                </listitem>
                <listitem>
                    org.eclipse.ui
                </listitem>
            </itemizedlist>
        
        In the plugin.xml you need to add the `org.eclipse.core.resources.natures`
            extension point.
        
            <mediaobject>
                <imageobject>
                    <imagedata fileref="images/exercise_project_nature_extension.png"/>
                </imageobject>
            </mediaobject>
        
        In the _ExampleProjectNature(run)_ we reference the
                `ExampleProjectNature` class:
        <programlisting language="java">
				<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" parse="text" href="./examples/ExampleProjectNature.java"/>
		</programlisting>
    
    <section>
        <title>Add a convert command
        Now use the `org.eclipse.ui.commands` extension point and add a command
            with `com.example.product.examplenature.command`  as
                _id_ and `Convert to Example Project` as
                _name_.
    
    <section>
        <title>Add a convert handler
        Add the `org.eclipse.ui.handlers` extension point and add a handler for the
                `com.example.product.examplenature.command` command. The class for the
            handler is `ExampleProjectNatureHandler` and looks like this:
        
            <programlisting language="java">
				<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" parse="text" href="./examples/ExampleProjectNatureHandler.java"/>
		</programlisting>
        
    
    <section>
        <title>Add the menu contribution for the conversion
        The id of the <guimenu>Configure</guimenu> menu in a projects context menu is
                `org.eclipse.ui.projectConfigure` and therefore the
                _locationURI_ of the _menuContribution_
            must be `popup:org.eclipse.ui.projectConfigure`. In this
                _menuContribution_ we then reference the defined
            command.
        
            <mediaobject>
                <imageobject>
                    <imagedata fileref="images/exercise_convert_menucontribution.png"/>
                </imageobject>
            </mediaobject>
        
    
    
        <title>Optional - Add a core expression
        As I already mentioned the <guimenu>Configure</guimenu> menu is only visible, in case
            it has elements in it, we should only apply the _menuContribution_
            to it, if the nature has not already been set.
        Therefore we want to add a core expression with the
                `org.eclipse.core.expressions.definitions` extension point.
        
            <mediaobject>
                <imageobject>
                    <imagedata fileref="images/exercise_core_expression.png"/>
                </imageobject>
            </mediaobject>
        
        The _id_ of the definition should be
                `com.example.project.hasNature`, which adapts
                `org.eclipse.core.resources.IProject` as _type_ and
            reuses a predefined `PropertyTester`, which is able to check for certain
            project natures. The _property_ of the `PropertyTester`
            is `org.eclipse.core.resources.projectNature`.
        
            <mediaobject>
                <imageobject>
                    <imagedata fileref="images/exercise_project_nature_propertytester.png"/>
                </imageobject>
            </mediaobject>
        
        Now we only need to reference this definition in a _visibleWhen_
            definition for the _menuContribution_.
        
            <mediaobject>
                <imageobject>
                    <imagedata fileref="images/exercise_visibleWhen_expression.png"/>
                </imageobject>
            </mediaobject>
        
        Do not forget to define _(not)_ and then reference the
                `com.example.project.hasNature` definition. The
                _(not)_ is not directly part of the definition itself, because
            we want to reuse this definition later on, where we want to ensure that the
                `com.example.project.examplenature` is applied to a project.
    
    <section>
        <title>Validate
        Start your plug-in within the Eclipse IDE and create a new _General
                Project_ and then right click the project and click on <guimenu>Configure
                > Convert to Example Project</guimenu>. In case you have done the optional part, the
                <guimenuitem>Convert to Example Project</guimenuitem>  menu item should not appear
            any more in the <guimenu>Configure</guimenu> menu.
    
  

